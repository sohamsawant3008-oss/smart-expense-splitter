<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add Expense</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='darkmode.css') }}">
</head>

<body>

<div class="container mt-5" style="max-width: 600px;">
    <div class="card shadow">
        <div class="card-header text-center">
            <h4>‚ûï Add Expense</h4>
        </div>

        <div class="card-body">
            <form method="POST" action="/add-expense" enctype="multipart/form-data">

                <!-- Description -->
                <div class="mb-3">
                    <label class="form-label">Description</label>
                    <input
                        type="text"
                        name="description"
                        class="form-control"
                        placeholder="Taxi, Dinner, Hotel..."
                        required>
                </div>

                <!-- Amount -->
                <div class="mb-3">
                    <label class="form-label">Amount (‚Çπ)</label>
                    <input
                        type="number"
                        step="0.01"
                        name="amount"
                        class="form-control"
                        required>
                </div>

                <!-- Payer -->
                <div class="mb-3">
                    <label class="form-label">Paid By</label>
                    <select name="payer" class="form-select" required>
                        <option value="">-- Select Payer --</option>
                        {% for user in group.users %}
                            <option value="{{ user.id }}">{{ user.name }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Participants -->
                <div class="mb-3">
                    <label class="form-label">Participants</label>

                    {% for user in group.users %}
                        <div class="form-check">
                            <input
                                class="form-check-input"
                                type="checkbox"
                                name="participants"
                                value="{{ user.id }}"
                                id="p{{ user.id }}">
                            <label class="form-check-label" for="p{{ user.id }}">
                                {{ user.name }}
                            </label>
                        </div>
                    {% endfor %}
                </div>

                <!-- Receipt Upload -->
                <div class="mb-3">
                    <label class="form-label">üì∏ Upload Receipt (Optional)</label>
                <!-- Category -->
                <div class="mb-3">
                    <label class="form-label">üè∑Ô∏è Category</label>
                    <select name="category" class="form-select">
                        <option value="Food">üçΩÔ∏è Food & Dining</option>
                        <option value="Transport">üöï Transport</option>
                        <option value="Accommodation">üè® Accommodation</option>
                        <option value="Entertainment">üé¨ Entertainment</option>
                        <option value="Shopping">üõçÔ∏è Shopping</option>
                        <option value="Activities">üéØ Activities</option>
                        <option value="Utilities">üí° Utilities</option>
                        <option value="Other" selected>üìå Other</option>
                    </select>
                </div>

                <!-- Notes -->
                <div class="mb-3">
                    <label class="form-label">üìù Notes (Optional)</label>
                    <textarea name="notes" class="form-control" placeholder="Add any additional notes..." rows="2"></textarea>
                </div>

                <!-- Tags -->
                <div class="mb-3">
                    <label class="form-label">üè∑Ô∏è Tags (Optional)</label>
                    <input type="text" name="tags" class="form-control" placeholder="Enter tags separated by commas (e.g., urgent, reimbursable)">
                </div>

                <!-- Receipt Upload -->
                <div class="mb-3">
                    <label class="form-label">üì∏ Upload Receipt (Optional)</label>
                    <input
                        type="file"
                        name="receipt"
                        class="form-control"
                        accept="image/png,image/jpg,image/jpeg,image/gif,application/pdf"
                        id="receiptInput">
                    <small class="form-text text-muted">Accepted formats: PNG, JPG, JPEG, GIF, PDF (Max 16MB)</small>
                    <div id="fileInfo" style="margin-top: 0.5rem;"></div>
                </div>

                <!-- Buttons -->
                <div class="d-flex justify-content-between mt-4">
                    <a href="/" class="btn btn-secondary">‚¨Ö Back</a>
                    <button type="submit" class="btn btn-primary">üíæ Add Expense</button>
                </div>

            </form>
        </div>
    </div>
</div>

<!-- File upload preview script -->
<script>
    const receiptInput = document.getElementById('receiptInput');
    const fileInfo = document.getElementById('fileInfo');
    
    receiptInput.addEventListener('change', function() {
        if (this.files && this.files[0]) {
            const file = this.files[0];
            const sizeMB = (file.size / 1024 / 1024).toFixed(2);
            fileInfo.innerHTML = `‚úÖ File selected: <strong>${file.name}</strong> (${sizeMB} MB)`;
            fileInfo.style.color = '#10b981';
        } else {
            fileInfo.innerHTML = '';
        }
    });
</script>

</body>
</html>
